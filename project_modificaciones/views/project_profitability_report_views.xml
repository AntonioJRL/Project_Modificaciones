<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <!-- ACTION -->
    <record id="action_project_profitability_report" model="ir.actions.act_window">
        <field name="name">Tablero de Rentabilidad de Proyecto/s</field>
        <field name="res_model">project.profitability.report</field>
        <field name="view_mode">form</field>
        <field name="target">new</field>
    </record>

    <!-- FORM VIEW -->
    <record id="view_project_profitability_report_form" model="ir.ui.view">
        <field name="name">project.profitability.report.form</field>
        <field name="model">project.profitability.report</field>
        <field name="arch" type="xml">
            <form string="Rentabilidad del Proyecto">
                <header>
                    <button name="action_recalculate" string="Recalcular" type="object"
                        class="btn-primary" icon="fa-refresh" />
                </header>
                <sheet>
                    <group>
                        <group>
                            <field name="project_id" options="{'no_create': True}" />
                            <field name="currency_id" invisible="1" />
                        </group>
                        <group>
                            <field name="filter_type" widget="radio" options="{'horizontal': true}" />
                            <field name="task_state_filter" invisible="filter_type == 'filter'"
                                widget="radio" options="{'horizontal': true}" />
                        </group>
                    </group>
                    <group invisible="filter_type != 'filter'">
                        <field name="task_ids" widget="many2many_tags" options="{'no_create': True}" />
                    </group>

                    <div class="o_horizontal_separator text-uppercase fw-bold mt-4 mb-3"
                        style="color: #495057; border-bottom: 2px solid #e9ecef; padding-bottom: 10px;">
                        <i class="fa fa-tachometer me-2" />Resumen Ejecutivo </div>

                    <style>
                        .kpi-container {
                        display: flex;
                        gap: 20px;
                        margin-bottom: 30px;
                        flex-wrap: wrap;
                        }
                        .kpi-box {
                        flex: 1;
                        min-width: 200px;
                        background: white;
                        border-radius: 12px;
                        padding: 20px;
                        box-shadow: 0 4px 15px rgba(0,0,0,0.05);
                        border: 1px solid rgba(0,0,0,0.05);
                        transition: transform 0.2s, box-shadow 0.2s;
                        display: flex;
                        align-items: center;
                        }
                        .kpi-box:hover {
                        transform: translateY(-2px);
                        box-shadow: 0 8px 25px rgba(0,0,0,0.1);
                        }
                        .kpi-icon-wrapper {
                        width: 50px;
                        height: 50px;
                        border-radius: 12px;
                        display: flex;
                        align-items: center;
                        justify-content: center;
                        margin-right: 15px;
                        font-size: 24px;
                        }
                        .kpi-content {
                        flex: 1;
                        }
                        .kpi-value {
                        font-size: 1.8rem;
                        font-weight: 700;
                        color: #212529;
                        line-height: 1.2;
                        }
                        .kpi-label {
                        color: #6c757d;
                        font-size: 0.85rem;
                        font-weight: 600;
                        text-transform: uppercase;
                        letter-spacing: 0.5px;
                        }
                        /* Colors */
                        .kpi-blue .kpi-icon-wrapper { background-color: #e7f1ff; color: #0d6efd; }
                        .kpi-green .kpi-icon-wrapper { background-color: #d1e7dd; color: #0f5132; }
                        .kpi-purple .kpi-icon-wrapper { background-color: #e0cffc; color: #6610f2; }
                        .kpi-orange .kpi-icon-wrapper { background-color: #ffe5d0; color: #fd7e14; }
                    </style>

                    <div class="kpi-container">
                        <!-- Tareas -->
                        <button name="action_view_tasks" type="object"
                            class="kpi-box kpi-blue border-0 text-start" style="cursor: pointer;">
                            <div class="kpi-icon-wrapper">
                                <i class="fa fa-tasks" />
                            </div>
                            <div class="kpi-content">
                                <div class="kpi-value">
                                    <field name="task_count" />
                                </div>
                                <div class="kpi-label">Tareas</div>
                            </div>
                        </button>

                        <!-- Ordenes Venta -->
                        <button name="action_view_sale_orders" type="object"
                            class="kpi-box kpi-green border-0 text-start" style="cursor: pointer;">
                            <div class="kpi-icon-wrapper">
                                <i class="fa fa-dollar" />
                            </div>
                            <div class="kpi-content">
                                <div class="kpi-value">
                                    <field name="sale_order_count" />
                                </div>
                                <div class="kpi-label">Órdenes Venta</div>
                            </div>
                        </button>

                        <!-- Ordenes Compra -->
                        <button name="action_view_purchase_orders" type="object"
                            class="kpi-box kpi-purple border-0 text-start" style="cursor: pointer;">
                            <div class="kpi-icon-wrapper">
                                <i class="fa fa-shopping-cart" />
                            </div>
                            <div class="kpi-content">
                                <div class="kpi-value">
                                    <field name="purchase_count" />
                                </div>
                                <div class="kpi-label">Órdenes Compra</div>
                            </div>
                        </button>

                        <!-- Gastos -->
                        <button name="action_view_expenses" type="object"
                            class="kpi-box kpi-blue border-0 text-start"
                            style="cursor: pointer; background: #e0f2f1; color: #00695c;">
                            <div class="kpi-icon-wrapper"
                                style="background: rgba(0, 105, 92, 0.1); color: #00695c;">
                                <i class="fa fa-credit-card" />
                            </div>
                            <div class="kpi-content">
                                <div class="kpi-value" style="color: #00695c;">
                                    <field name="expense_count" />
                                </div>
                                <div class="kpi-label" style="color: #004d40;">Gastos</div>
                            </div>
                        </button>

                        <!-- Requisiciones -->
                        <button name="action_view_requisitions" type="object"
                            class="kpi-box kpi-purple border-0 text-start"
                            style="cursor: pointer; background: #f3e5f5; color: #7b1fa2;">
                            <div class="kpi-icon-wrapper"
                                style="background: rgba(123, 31, 162, 0.1); color: #7b1fa2;">
                                <i class="fa fa-list-alt" />
                            </div>
                            <div class="kpi-content">
                                <div class="kpi-value" style="color: #7b1fa2;">
                                    <field name="requisition_count" />
                                </div>
                                <div class="kpi-label" style="color: #4a148c;">Requisiciones</div>
                            </div>
                        </button>

                        <!-- Horas -->
                        <button name="action_view_timesheets" type="object"
                            class="kpi-box kpi-orange border-0 text-start" style="cursor: pointer;">
                            <div class="kpi-icon-wrapper">
                                <i class="fa fa-clock-o" />
                            </div>
                            <div class="kpi-content">
                                <div class="kpi-value">
                                    <field name="timesheet_hours" widget="float_time" />
                                </div>
                                <div class="kpi-label">Horas Reg.</div>
                            </div>
                        </button>
                    </div>

                    <field name="content" widget="html" nolabel="1" />
                </sheet>
            </form>
        </field>
    </record>

    <!-- QWEB TEMPLATE -->
    <template id="project_profitability_template">
        <div class="o_dashboard_container p-2 animate-fade-in">
            <style>
                .o_dashboard_container { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI",
                Roboto, "Helvetica Neue", Arial, sans-serif; color: #212529; background-color:
                #f8f9fa; border-radius: 8px; }
                .kpi-card { background: white; border-radius: 12px; box-shadow: 0 2px 12px
                rgba(0,0,0,0.04); border: 1px solid rgba(0,0,0,0.05); overflow: hidden;
                margin-bottom: 20px; }
                .kpi-table th { background-color: #fcfcfc; text-transform: uppercase; font-size:
                0.75rem; letter-spacing: 0.5px; color: #6c757d; border-bottom: 1px solid #eee;
                padding: 12px 8px; }
                .kpi-table td { padding: 12px 8px; vertical-align: middle; border-bottom: 1px solid
                #f0f0f0; font-size: 0.9rem; }
                .section-header { background-color: #f8f9fa; font-weight: bold; color: #495057;
                font-size: 0.85rem; padding: 8px 12px; border-bottom: 1px solid #eee; border-top:
                1px solid #eee; }
                .badge-percent { padding: 4px 8px; border-radius: 6px; font-size: 0.8rem;
                font-weight: 600; display: inline-block; min-width: 60px; text-align: center; }
                .active-dot { height: 6px; width: 6px; background-color: #28a745; border-radius:
                50%; display: inline-block; margin-right: 6px; vertical-align: middle; box-shadow: 0
                0 4px rgba(40, 167, 69, 0.4); }
                .bg-soft-success { background-color: #d1e7dd; color: #0f5132; }
                .bg-soft-danger { background-color: #f8d7da; color: #842029; }
                .table-scroll-container { max-height: 400px; overflow-y: auto; }
                @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity:
                1; transform: translateY(0); } }
                .animate-fade-in { animation: fadeIn 0.4s ease-out forwards; }
            </style>

            <div class="kpi-card">
                <div class="p-3 border-bottom">
                    <h5 class="m-0 fw-bold text-primary"><i class="fa fa-pie-chart me-2" />Rentabilidad
                        Consolidada</h5>
                </div>
                <div class="table-responsive">
                    <table class="table kpi-table table-borderless mb-0">
                        <colgroup>
                            <col style="width:20%" />
                            <col style="width:20%" />
                            <col style="width:20%" />
                            <col style="width:20%" />
                            <col style="width:20%" />
                        </colgroup>
                        <thead>
                            <tr>
                                <th>Concepto</th>
                                <th></th>
                                <th class="text-center">Facturado</th>
                                <th class="text-center">Por Facturar</th>
                                <th class="text-center">Esperado/Total</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td colspan="5" class="section-header">INGRESOS</td>
                            </tr>
                            <tr>
                                <td class="ps-4 fw-bold text-dark"><span class="active-dot" />
                                    Producción</td>
                                <td></td>
                                <td class="text-center fw-bold text-dark">
                                    <t t-out="format_monetary(profitability['invoiced_income'])" />
                                </td>
                                <td class="text-center text-muted">
                                    <t t-out="format_monetary(profitability['to_invoice_income'])" />
                                </td>
                                <td class="text-center fw-bold text-dark">
                                    <t t-out="format_monetary(profitability['expected_income'])" />
                                </td>
                            </tr>

                            <tr>
                                <td colspan="5" class="section-header">COSTOS</td>
                            </tr>

                            <tr>
                                <td
                                    t-attf-class="ps-4 #{'text-dark fw-bold' if profitability['total_expenses'] > 0 else 'text-secondary'}">
                                    Gastos</td>
                                <td></td>
                                <td></td>
                                <td></td>
                                <td
                                    t-attf-class="text-center fw-bold #{'text-dark' if profitability['total_expenses'] > 0 else 'text-muted'}">
                                    <t t-out="format_monetary(-profitability['total_expenses'])" />
                                </td>
                            </tr>
                            <tr>
                                <td
                                    t-attf-class="ps-4 #{'text-dark fw-bold' if profitability['total_purchases'] > 0 else 'text-secondary'}">
                                    Compras</td>
                                <td></td>
                                <td></td>
                                <td></td>
                                <td
                                    t-attf-class="text-center fw-bold #{'text-dark' if profitability['total_purchases'] > 0 else 'text-muted'}">
                                    <t t-out="format_monetary(-profitability['total_purchases'])" />
                                </td>
                            </tr>
                            <tr>
                                <td
                                    t-attf-class="ps-4 #{'text-dark fw-bold' if profitability['timesheet_cost'] > 0 else 'text-secondary'}">Hojas
                                    de Horas</td>
                                <td></td>
                                <td></td>
                                <td></td>
                                <td
                                    t-attf-class="text-center fw-bold #{'text-dark' if profitability['timesheet_cost'] > 0 else 'text-muted'}">
                                    <t t-out="format_monetary(-profitability['timesheet_cost'])" />
                                </td>
                            </tr>
                            <tr>
                                <td
                                    t-attf-class="ps-4 #{'text-dark fw-bold' if profitability['total_stock_moves'] > 0 else 'text-secondary'}">Mov.
                                    Almacén</td>
                                <td></td>
                                <td></td>
                                <td></td>
                                <td
                                    t-attf-class="text-center fw-bold #{'text-dark' if profitability['total_stock_moves'] > 0 else 'text-muted'}">
                                    <t t-out="format_monetary(-profitability['total_stock_moves'])" />
                                </td>
                            </tr>

                            <tr class="bg-light">
                                <td class="ps-4 fw-bold">Margen Total</td>
                                <td></td>
                                <td></td>
                                <td></td>
                                <td
                                    t-attf-class="text-center fw-bold fs-6 p-3 #{'text-success' if profitability['margin_total'] &gt;= 0 else 'text-danger'}">
                                    <t t-out="format_monetary(profitability['margin_total'])" />
                                </td>
                            </tr>
                        </tbody>
                        <tfoot>
                            <tr>
                                <td></td>
                                <td></td>
                                <td></td>
                                <td></td>
                                <td class="text-center pb-3">
                                    <div
                                        t-attf-class="badge-percent #{'bg-soft-success' if profitability['profit_percentage'] &gt;= 0 else 'bg-soft-danger'}">
                                        <t
                                            t-out="format_percentage(profitability['profit_percentage'])" />
                                    </div>
                                </td>
                            </tr>
                        </tfoot>
                    </table>
                </div>
            </div>

            <!-- GRÁFICOS Y ANÁLISIS VISUAL -->
            <div class="kpi-card mt-4">
                <div class="p-3 border-bottom">
                    <h6 class="m-0 fw-bold text-dark"><i class="fa fa-bar-chart me-2 text-primary" />Distribución
                        de Costos</h6>
                </div>
                <div class="p-4">
                    <style>
                        .legend-item {
                        transition: background-color 0.2s;
                        border-left: 4px solid transparent;
                        }
                        .legend-item:hover {
                        background-color: rgba(0,0,0,0.02);
                        }
                        .legend-label {
                        font-size: 0.95rem;
                        font-weight: 600;
                        color: #495057;
                        }
                        .legend-amount {
                        font-size: 1rem;
                        font-weight: 700;
                        color: #212529;
                        }
                        .badge-legend {
                        font-size: 0.9rem;
                        padding: 6px 10px;
                        border-radius: 6px;
                        font-weight: 700;
                        min-width: 70px;
                        text-align: center;
                        box-shadow: 0 1px 2px rgba(0,0,0,0.05);
                        }
                        /* High contrast badges */
                        .badge-stock { background-color: #ffebee; color: #c62828; border: 1px solid
                        #ffcdd2; }
                        .badge-purchase { background-color: #e3f2fd; color: #1565c0; border: 1px
                        solid #bbdefb; }
                        .badge-timesheet { background-color: #fff3e0; color: #ef6c00; border: 1px
                        solid #ffe0b2; }
                        .badge-expense { background-color: #f3e5f5; color: #6a1b9a; border: 1px
                        solid #e1bee7; }
                    </style>

                    <t t-if="profitability['total_costs'] > 0">
                        <div class="row align-items-center">
                            <div class="col-md-5 d-flex justify-content-center mb-4 mb-md-0">
                                <!-- CSS CONIC GRADIENT CHART -->
                                <div class="chart-container"
                                    style="position: relative; width: 220px; height: 220px; border-radius: 50%; opacity: 0; animation: fadeIn 0.8s forwards; box-shadow: 0 4px 15px rgba(0,0,0,0.1);">
                                    <div class="chart-pie" t-attf-style="{{ chart_data['style'] }}">
                                    </div>
                                    <div class="chart-inner"
                                        style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); width: 65%; height: 65%; background: white; border-radius: 50%; display: flex; align-items: center; justify-content: center; flex-direction: column; box-shadow: inset 0 2px 5px rgba(0,0,0,0.05);">
                                        <span class="text-muted small text-uppercase fw-bold mb-1">Total
                                            Costos</span>
                                        <span class="fw-bold fs-4 text-dark">
                                            <t t-out="format_monetary(profitability['total_costs'])" />
                                        </span>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-7">
                                <h6
                                    class="mb-4 text-muted text-uppercase small fw-bold border-bottom pb-2">Detalle
                                    de Distribución</h6>
                                <div class="d-flex flex-column gap-3">
                                    <!-- Stock -->
                                    <div class="d-flex align-items-center p-2 rounded legend-item"
                                        style="border-left-color: #dc3545;">
                                        <div class="d-flex flex-column flex-grow-1 ms-2">
                                            <span class="legend-label">Materiales (Stock)</span>
                                            <span class="legend-amount">
                                                <t
                                                    t-out="format_monetary(profitability['total_stock_moves'])" />
                                            </span>
                                        </div>
                                        <span class="badge-legend badge-stock">
                                            <t t-out="format_percentage(chart_data['stock_pct'])" />
                                        </span>
                                    </div>

                                    <!-- Compras -->
                                    <div class="d-flex align-items-center p-2 rounded legend-item"
                                        style="border-left-color: #0d6efd;">
                                        <div class="d-flex flex-column flex-grow-1 ms-2">
                                            <span class="legend-label">Compras Directas</span>
                                            <span class="legend-amount">
                                                <t
                                                    t-out="format_monetary(profitability['total_purchases'])" />
                                            </span>
                                        </div>
                                        <span class="badge-legend badge-purchase">
                                            <t
                                                t-out="format_percentage(chart_data['purchases_pct'])" />
                                        </span>
                                    </div>

                                    <!-- Horas -->
                                    <div class="d-flex align-items-center p-2 rounded legend-item"
                                        style="border-left-color: #fd7e14;">
                                        <div class="d-flex flex-column flex-grow-1 ms-2">
                                            <span class="legend-label">Mano de Obra (Horas)</span>
                                            <span class="legend-amount">
                                                <t
                                                    t-out="format_monetary(profitability['timesheet_cost'])" />
                                            </span>
                                        </div>
                                        <span class="badge-legend badge-timesheet">
                                            <t
                                                t-out="format_percentage(chart_data['timesheets_pct'])" />
                                        </span>
                                    </div>

                                    <!-- Gastos -->
                                    <div class="d-flex align-items-center p-2 rounded legend-item"
                                        style="border-left-color: #6610f2;">
                                        <div class="d-flex flex-column flex-grow-1 ms-2">
                                            <span class="legend-label">Gastos (Reembolsos)</span>
                                            <span class="legend-amount">
                                                <t
                                                    t-out="format_monetary(profitability['total_expenses'])" />
                                            </span>
                                        </div>
                                        <span class="badge-legend badge-expense">
                                            <t t-out="format_percentage(chart_data['expenses_pct'])" />
                                        </span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </t>
                    <t t-else="">
                        <div class="text-center p-4 text-muted">
                            <i class="fa fa-info-circle fa-2x mb-3" />
                            <p>No hay costos registrados para visualizar el gráfico de distribución.</p>
                        </div>
                    </t>
                </div>
            </div>

            <!-- DETALLE DE COMPRAS -->
            <div t-if="purchases_list" class="kpi-card mt-4">
                <div class="p-3 border-bottom d-flex justify-content-between align-items-center">
                    <h6 class="m-0 fw-bold text-dark"><i
                            class="fa fa-shopping-cart me-2 text-success" />Detalle de Compras
                        (Drill-down)</h6>
                </div>
                <div class="table-responsive table-scroll-container">
                    <table class="table table-sm table-hover align-middle mb-0">
                        <thead class="bg-light sticky-top" style="z-index: 1;">
                            <tr>
                                <th class="ps-3">Pedido</th>
                                <th>Fecha</th>
                                <th>Proveedor</th>
                                <th>Producto</th>
                                <th class="text-center">Estado</th>
                                <th class="text-end">Cant.</th>
                                <th class="text-end pe-3">Total</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr t-foreach="purchases_list" t-as="po">
                                <td class="ps-3 fw-bold">
                                    <t t-esc="po['order_name']" />
                                </td>
                                <td
                                    class="text-muted">
                                    <span t-esc="po['date']" t-options='{"widget": "date"}' />
                                </td>
                                <td>
                                    <t t-esc="po['partner']" />
                                </td>
                                <td>
                                    <t t-esc="po['product']" />
                                </td>
                                <td
                                    class="text-center">
                                    <span
                                        t-attf-class="badge rounded-pill #{'bg-success' if po['state_raw'] == 'purchase' or po['state_raw'] == 'done' else 'bg-secondary'}"
                                        t-esc="po['state']" />
                                </td>
                                <td class="text-end">
                                    <t t-esc="po['qty']" />
                                </td>
                                <td class="text-end pe-3 fw-bold">
                                    <t t-out="format_monetary(po['total'])" />
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- DETALLE DE GASTOS -->
            <div t-if="expenses_list" class="kpi-card mt-4">
                <div class="p-3 border-bottom d-flex justify-content-between align-items-center">
                    <h6 class="m-0 fw-bold text-dark"><i class="fa fa-money me-2 text-warning" />Detalle
                        de Gastos (Drill-down)</h6>
                </div>
                <div class="table-responsive table-scroll-container">
                    <table class="table table-sm table-hover align-middle mb-0">
                        <thead class="bg-light sticky-top" style="z-index: 1;">
                            <tr>
                                <th class="ps-3">Descripción</th>
                                <th>Empleado</th>
                                <th>Fecha</th>
                                <th>Informe</th>
                                <th class="text-center">Estado</th>
                                <th class="text-end pe-3">Total</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr t-foreach="expenses_list" t-as="exp">
                                <td class="ps-3 fw-bold">
                                    <t t-esc="exp['product']" />
                                </td> <!--
                                Usamos product name como desc breve -->
                                <td>
                                    <t t-esc="exp['employee']" />
                                </td>
                                <td class="text-muted">
                                    <span t-esc="exp['date']" t-options='{"widget": "date"}' />
                                </td>
                                <td>
                                    <t t-esc="exp['sheet_name']" />
                                </td>
                                <td class="text-center">
                                    <span
                                        t-attf-class="badge rounded-pill #{'bg-success' if exp['state_raw'] == 'done' or exp['state_raw'] == 'post' else 'bg-warning'}"
                                        t-esc="exp['state']" />
                                </td>
                                <td
                                    class="text-end pe-3 fw-bold">
                                    <t t-out="format_monetary(exp['total'])" />
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- TABLA DE MOVIMIENTOS DE ALMACEN DETALLADA -->
            <div t-if="stock_moves_list" class="kpi-card mt-4">
                <div class="p-3 border-bottom d-flex justify-content-between align-items-center">
                    <h6 class="m-0 fw-bold text-dark"><i class="fa fa-cubes me-2 text-primary" />Detalle
                        de Materiales Consolidados</h6>
                </div>
                <div class="table-responsive table-scroll-container">
                    <table class="table table-sm table-hover align-middle mb-0">
                        <thead class="bg-light sticky-top" style="z-index: 1;">
                            <tr>
                                <th class="ps-3 text-center">Estado</th>
                                <th class="text-center">Tarea</th>
                                <th class="text-center">Fecha</th>
                                <th class="text-center">Referencia</th>
                                <th>Producto</th>
                                <th>Ubicaciones</th>
                                <th class="text-end">Cant.</th>
                                <th class="text-end">Costo Unit.</th>
                                <th class="text-end pe-3">Total</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr t-foreach="stock_moves_list" t-as="move">
                                <td class="text-center ps-3">
                                    <span
                                        t-attf-class="badge rounded-pill fw-bold #{'bg-success text-white' if move['state_raw'] == 'done' else 'bg-warning text-dark'}"
                                        style="font-size: 0.85rem; padding: 6px 12px; box-shadow: 0 2px 4px rgba(0,0,0,0.15); letter-spacing: 0.5px;"
                                        t-esc="move['state_label']" />
                                </td>
                                <td class="text-center text-muted" style="max-width: 180px;">
                                    <span t-esc="move['task_name']" t-att-title="move['task_name']"
                                        class="badge bg-light text-dark border text-truncate"
                                        style="max-width: 100%; display: inline-block; vertical-align: bottom;" />
                                </td>
                                <td class="text-center text-muted">
                                    <small t-esc="move['date']" t-options='{"widget": "date"}' />
                                </td>
                                <td class="text-center">
                                    <a t-att-href="move['picking_url']" target="_blank"
                                        class="text-decoration-none fw-bold text-primary"
                                        style="font-size: 0.9rem;">
                                        <t t-esc="move['picking']" />
                                    </a>
                                </td>
                                <td>
                                    <span class="fw-bold text-dark" t-esc="move['product_name']" />
                                    <div t-if="move['lot_name'] != '-'"
                                        class="small text-muted mt-1">
                                        <i class="fa fa-barcode me-1" />
                                        <t t-esc="move['lot_name']" />
                                    </div>
                                </td>
                                <td>
                                    <div class="d-flex flex-column small" style="line-height: 1.2;">
                                        <div>
                                            <span class="text-muted me-1">De:</span>
                                            <span class="text-dark" t-esc="move['location_id']" />
                                        </div>
                                        <div>
                                            <span class="text-muted me-1">A:</span>
                                            <span class="text-dark" t-esc="move['location_dest_id']" />
                                        </div>
                                    </div>
                                </td>
                                <td class="text-end">
                                    <span class="fw-bold" t-esc="move['quantity']" />
                                    <small class="text-muted ms-1" t-esc="move['uom']" />
                                </td>
                                <td class="text-end text-muted">
                                    <small>
                                        <t t-out="format_monetary(move['price_unit'])" />
                                    </small>
                                </td>
                                <td class="text-end fw-bold text-danger pe-3">
                                    <t t-out="format_monetary(move['total_cost'])" />
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </template>
</odoo>